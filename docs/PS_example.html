<!-- HTML header for doxygen 1.9.3-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SpinDec2: Pseudo-Spectral Example</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
  <script type="text/javascript">
      DoxygenAwesomeDarkModeToggle.init()
  </script>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script> 
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">SpinDec2
   </div>
   <div id="projectbrief">Software Modelling Spinodal Decomposition</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
<div id="nav-tree">
    <div id="nav-tree-contents">
    <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('PS_example.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle"><div class="title">Examples - Pseudo-Spectral Example</div></div>
  <!-- start footer part -->
    
</div><!--header-->

<p>To run the code using the pseudo-spectral solver,, the problem variable in your <code markup="tt" class=" language-none">input.txt</code>
   file needs to be set to "spectral".
  You must also make sure you set the variables <code markup="tt" class=" language-none">mobility_a</code> and
   <code markup="tt" class=" language-none">mobility_b</code> to the values you want to simulate, as spectral can only simulate with a constant mobility field 
   that is calculated from the Darkens equation (<a href="mobility.html">definition</a>).
   Again, we shall set the atomic mobilities to four, such that \(M\) is equal to one for an initial average concentration of 0.5.
  The spectral solver is less sensitive to the set timestep compared to the serial Eulerian solver; however, it still needs to be small when the 
  <code markup="tt" class=" language-none">stabilization_term</code> parameter is set to zero. Below is an example of an input file that can be used for 
the spectral solver in SpinDec2:</p>
  
<pre><samp>
  concentration_max = 0.6
  concentration_min = 0.4
  domain_x_size = 128
  domain_y_size = 128
  mobility_a = 4
  mobility_b = 4
  free_energy_gradient_parameter = 0.0001
  bulk_free_energy = 1
  checkpoint_interval = 5000
  checkpoint_output_file = "out.cp"
  checkpoint_input_file = "out.cp"
  max_time = 4e-2
  time_step = 1e-5
  random_seed = 1234
  use_input = 0
  excitation_a = 1
  excitation_b = 2
  temperature_min = 950
  temperature_max = 1050
  problem = "spectral"
  stabilization_term = 0
  write_frequency = 1
  single_precision = 0
</samp></pre>

<p>The spectral method calculates the new grid at each iteration is different from the serial method, but we should expect the physics to be 
  the same for both. We can expect slightly different patterns due to numerical differences from using FFTs rather than finite differences. Still, we should expect to see
  the same free energy trend for both methods. Below are the results for both the spectral solver and the serial solver using the "constant" mobility definition (seen in 
  <a href="euler_example_1.html">Example 1</a>).
</p>



<h4>Pseudo-Spectral Solver</h4>
<center>
  <p> <img src="user_examples/Spectral/spec_start.png"  width="350" height="350">
     <img src="user_examples/Spectral/spec_mid.png"  width="350" height="350"> 
     <img src="user_examples/Spectral/spec_end.png"  width="350" height="350">  
     <img src="user_examples/Spectral/F_spec.png"  width="350" height="350"></p>
    </center>




<h4>Serial Solver</h4>
<center>
  <p> <img src="user_examples/Constant/constant_start_46_A_1.png"  width="350" height="350">
     <img src="user_examples/Constant/constant_quarter_46_A_1.png"  width="350" height="350"> 
     <img src="user_examples/Constant/constant_end_46_A_1.png"  width="350" height="350">  
     <img src="user_examples/Constant/F_46_A_1.png"  width="350" height="350"></p>
    </center>

  <p>From the above, we can see that the two solvers produce similar results and exhibit the same physical behaviours.</p>

<h2>Probing Deeper In Time</h2>
<p>As stated before, the spectral solver is able to use larger time steps, even with the <code markup="tt" class=" language-none">stabilization_term</code> set to zero.
  This allows us to simulate further in time without requiring large amounts of memory (i.e. smaller number of iterations). The input file example below uses the same time step
  and physical parameters as before but simulates the binary alloy system ten times longer.
</p>


<pre><samp>
  concentration_max = 0.6
  concentration_min = 0.4
  domain_x_size = 128
  domain_y_size = 128
  mobility_a = 4
  mobility_b = 4
  free_energy_gradient_parameter = 0.0001
  bulk_free_energy = 1
  checkpointing_interval = 5000
  checkpoint_output_file = "out.cp"
  kcheckpoint_input_file = "out.cp"
  max_time = 4e-1
  time_step = 1e-5
  random_seed = 1234
  use_input = 0
  excitation_a = 1
  excitation_b = 2
  temperature_min = 950
  temperature_max = 1050
  problem = "spectral"
  stabilization_term = 0
  write_frequency = 1
  single_precision = 0
</samp></pre>

<p>The result from the input file is shown below:</p>

<center>
  <p> <img src="user_examples/Spectral/spec_extra.png"  width="500" height="500"></p>
    </center>

    As we go further in time, the binary alloy starts to clump into more significant regions that are purely zero and one.

<h2>Changing The Stabilization Term</h2>
<p>Using the <code markup="tt" class=" language-none">stabilization_term</code>, we can now use even larger timesteps as the 
stability of the solver is enhanced. The downside of using a more negative value of stabilization is that it reduces the physical accuracy of the solver 
for the early period. However, as we are only interested in simulating for a long period, we don't have to worry about it too much.
For this example, we will use a <code markup="tt" class=" language-none">stabilization_term</code> value set to -2, and a time step and final time of 0.01 and 1 respectively. </p>
<pre><samp>
  concentration_max = 0.6
  concentration_min = 0.4
  domain_x_size = 128
  domain_y_size = 128
  mobility_a = 4
  mobility_b = 4
  free_energy_gradient_parameter = 0.0001
  bulk_free_energy = 1
  checkpointing_interval = 5000
  checkpoint_output_file = "out.cp"
  kcheckpoint_input_file = "out.cp"
  max_time = 1e1
  time_step = 1e-2
  random_seed = 1234
  use_input = 0
  excitation_a = 1
  excitation_b = 2
  temperature_min = 950
  temperature_max = 1050
  problem = "spectral"
  stabilization_term = -2
  write_frequency = 1
  single_precision = 0
</samp></pre>

<p>The result from the input file is shown below:</p>

<center>
  <p> <img src="user_examples/Spectral/spec_stab_2_first.png"  width="450" height="450">
  <img src="user_examples/Spectral/spec_stab_2mid.png"  width="450" height="450">
  <img src="user_examples/Spectral/spec_stab_2_end.png"  width="450" height="450"></p>
    </center>
<p>We can see even further evoloution from the previous figure, with the final snapshot showing a complelty stable end state of purley horizontal regions of the \(A\)
and \(B\) species.</p>
  <div class="contents">
</div><!-- contents -->
</div><!-- doc-content -->
<p>Authors: Anas Siddiqui, Ben Gosling, Dyaln Morgan, Geraldine Anis, Matyas Parrag</p>
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
